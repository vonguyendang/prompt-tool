<!DOCTYPE html>
<html lang="en" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4R4S Prompt Pro</title>
    <link rel="icon" type="image/png" href="favicon_io/android-chrome-512x512.png">
    <meta name="description" content="Generate AI prompts with 4R4S method">
    <meta name="keywords" content="4R4S, AI, Prompt, Generator">
    <meta name="author" content="DANGVO">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                    }
                }
            }
        }
    </script>
</head>

<body class="flex flex-col h-full font-sans transition-colors duration-200">

    <!-- Header -->
    <header class="h-14 flex-none z-10 transition-colors">
        <div class="max-w-screen-2xl mx-auto px-4 h-full flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <span class="text-xl">üöÄ</span>
                <h1 class="font-bold text-lg tracking-tight">4R4S Prompt Pro</h1>
            </div>
            <div class="flex items-center space-x-3">
                <button id="themeToggle"
                    class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                    title="Toggle Theme">
                    <span class="dark:hidden">‚òÄÔ∏è</span>
                    <span class="hidden dark:inline">üåô</span>
                </button>
                <button id="clearBtn" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                    title="Reset All">
                    üîÑ
                </button>
                <div class="relative group">
                    <button
                        class="px-3 py-1.5 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        ‚≠ê Templates
                    </button>
                    <!-- Template Dropdown -->
                    <div
                        class="absolute right-0 mt-2 w-64 glass-panel invisible group-hover:visible opacity-0 group-hover:opacity-100 transition-all z-50 p-2">
                        <div id="templateList" class="max-h-80 overflow-y-auto space-y-1">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content (3 Panels) -->
    <main
        class="flex-1 flex flex-col lg:flex-row lg:overflow-hidden overflow-y-auto max-w-screen-2xl mx-auto w-full p-4 gap-4">

        <!-- PANEL 1: QUICK IDEA (30%) -->
        <section class="flex-none lg:w-[30%] flex flex-col p-6 glass-panel panel-idea relative">
            <h2 class="text-xs font-bold uppercase tracking-wider mb-4 flex items-center">
                <span class="mr-2">üí°</span> Quick Idea
            </h2>
            <div class="flex-1 flex flex-col space-y-4">
                <div class="relative flex-1">
                    <textarea id="ideaInput" class="form-input w-full h-full resize-none text-lg"
                        placeholder="e.g. Write a LinkedIn post about AI tools for marketing..."></textarea>

                    <!-- Loader -->
                    <div id="loader"
                        class="absolute inset-0 z-20 backdrop-blur-sm flex items-center justify-center rounded-xl hidden">
                        <div class="loading-spinner"></div>
                    </div>

                    <!-- Absolute Attachment Controls (Bottom Right) -->
                    <div class="absolute bottom-3 right-3 flex items-center space-x-2">
                        <!-- Preview Pill -->
                        <div id="attachmentPreview"
                            class="hidden flex items-center bg-white dark:bg-gray-800 rounded-full border border-gray-200 dark:border-gray-700 shadow-sm pl-1 pr-2 py-0.5">
                            <img id="previewImg" src="" class="h-6 w-6 object-cover rounded-full">
                            <button id="clearAttachment"
                                class="ml-1 text-gray-400 hover:text-red-500 rounded-full p-0.5">√ó</button>
                        </div>

                        <!-- Attach Button -->
                        <label
                            class="cursor-pointer p-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full transition-colors opacity-70 hover:opacity-100">
                            <span>üìé</span>
                            <input type="file" id="fileInput" class="hidden"
                                accept="image/png, image/jpeg, image/webp, image/gif">
                        </label>
                    </div>
                </div>
                <button id="autoFillBtn"
                    class="w-full py-4 rounded-xl btn-vibrant active:scale-[0.98] transition-all flex items-center justify-center space-x-2 group mt-4">
                    <span class="group-hover:animate-pulse">‚ú®</span>
                    <span>AI Auto-Fill Magic</span>
                </button>
                <div class="text-center text-xs text-gray-400">
                    ~3s to analyze & classify
                </div>
            </div>
        </section>

        <!-- PANEL 2: SMART FORM 4R4S (40%) -->
        <section
            class="flex-none lg:flex-1 lg:w-[40%] flex flex-col p-6 glass-panel panel-form lg:overflow-y-auto custom-scrollbar">
            <h2 class="text-xs font-bold uppercase tracking-wider mb-4 flex items-center justify-between">
                <div><span class="mr-2">üéØ</span> Smart Form 4R-4S</div>
                <div class="flex items-center space-x-2">
                    <!-- Language Toggle -->
                    <div class="flex bg-gray-200 dark:bg-gray-700 rounded-lg p-0.5">
                        <button id="langVN"
                            class="px-2 py-0.5 text-[10px] font-bold rounded bg-white dark:bg-gray-600 shadow-sm transition-all">VN</button>
                        <button id="langEN"
                            class="px-2 py-0.5 text-[10px] font-bold rounded opacity-60 hover:opacity-100 transition-all">EN</button>
                    </div>
                </div>
            </h2>

            <div class="space-y-4">
                <!-- 4R Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="form-group">
                        <label id="lblRole" class="block text-xs font-bold mb-1">ROLE</label>
                        <textarea id="fRole" rows="2" class="form-input" placeholder="Who is acting?"></textarea>
                    </div>
                    <div class="form-group">
                        <label id="lblSituation" class="block text-xs font-bold mb-1">SITUATION</label>
                        <textarea id="fSituation" rows="2" class="form-input" placeholder="Context/Problem"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label id="lblReason" class="block text-xs font-bold mb-1">REASON (GOAL)</label>
                    <textarea id="fReason" rows="2" class="form-input" placeholder="What is the objective?"></textarea>
                </div>

                <div class="form-group">
                    <label id="lblRules" class="block text-xs font-bold mb-1">RULES
                        (CONSTRAINTS)</label>
                    <textarea id="fRules" rows="3" class="form-input"
                        placeholder="Format, tone, restrictions..."></textarea>
                </div>

                <div class="form-group">
                    <label id="lblResult" class="block text-xs font-bold mb-1">RESULT (FORMAT)</label>
                    <textarea id="fResult" rows="2" class="form-input" placeholder="Output format"></textarea>
                </div>

                <!-- Settings Row -->
                <div class="grid grid-cols-3 gap-3">
                    <div>
                        <label id="lblLength" class="block text-xs font-bold mb-1">LENGTH</label>
                        <input type="number" id="fLength" class="form-input py-2 h-10" placeholder="Words">
                    </div>
                    <div>
                        <label id="lblStrict" class="block text-xs font-bold mb-1">STRICT</label>
                        <select id="fStrict" class="form-input py-2 h-10">
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                        </select>
                    </div>
                    <div class="flex items-end justify-center pb-2">
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fSteps"
                                class="w-5 h-5 text-primary rounded border-gray-300 focus:ring-primary">
                            <span class="text-xs font-medium">Add Steps</span>
                        </label>
                    </div>
                </div>

                <!-- Hidden Preview Area -->
                <!-- Preview Area (Always Visible at Bottom) -->
                <div id="previewArea" class="mt-8 flex-1 flex flex-col min-h-[200px]">
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-xs font-bold">FULL PROMPT PREVIEW</label>
                        <button id="copyPromptBtn"
                            class="px-3 py-1 bg-primary text-white text-[10px] font-bold rounded-lg shadow-md hover:bg-indigo-600 transition-all active:scale-95 flex items-center space-x-1">
                            <span>üìã</span> <span>Copy Prompt</span>
                        </button>
                    </div>
                    <pre
                        class="flex-1 text-xs rounded-lg p-3 overflow-x-auto custom-scrollbar"><code id="promptPreview" class="language-markdown"></code></pre>
                </div>

                <!-- AI Quick Launch Buttons -->
                <div class="mt-4 grid grid-cols-2 gap-2 sm:grid-cols-3 xl:grid-cols-5">
                    <button onclick="openAIResource('chatgpt')"
                        class="flex items-center justify-center space-x-2 px-3 py-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors text-xs font-bold border border-green-200 dark:border-green-800">
                        <span>ü§ñ</span> <span>ChatGPT</span>
                    </button>
                    <button onclick="openAIResource('gemini')"
                        class="flex items-center justify-center space-x-2 px-3 py-2 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors text-xs font-bold border border-blue-200 dark:border-blue-800">
                        <span>üíé</span> <span>Gemini</span>
                    </button>
                    <button onclick="openAIResource('perplexity')"
                        class="flex items-center justify-center space-x-2 px-3 py-2 bg-teal-100 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300 rounded-lg hover:bg-teal-200 dark:hover:bg-teal-900/50 transition-colors text-xs font-bold border border-teal-200 dark:border-teal-800">
                        <span>üîç</span> <span>Perplexity</span>
                    </button>
                    <button onclick="openAIResource('deepseek')"
                        class="flex items-center justify-center space-x-2 px-3 py-2 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded-lg hover:bg-indigo-200 dark:hover:bg-indigo-900/50 transition-colors text-xs font-bold border border-indigo-200 dark:border-indigo-800">
                        <span>üê≥</span> <span>DeepSeek</span>
                    </button>
                    <button onclick="openAIResource('claude')"
                        class="flex items-center justify-center space-x-2 px-3 py-2 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 rounded-lg hover:bg-orange-200 dark:hover:bg-orange-900/50 transition-colors text-xs font-bold border border-orange-200 dark:border-orange-800">
                        <span>üß†</span> <span>Claude</span>
                    </button>
                </div>
                <!-- Paste Instruction -->
                <div id="lblPasteTip" class="mt-3 text-center text-[10px] text-gray-400 italic">
                    üí° M·∫πo: Sau khi m·ªü, nh·∫•n <kbd
                        class="font-sans font-bold bg-gray-100 dark:bg-gray-800 px-1 rounded">Cmd+V</kbd> (Mac) ho·∫∑c
                    <kbd class="font-sans font-bold bg-gray-100 dark:bg-gray-800 px-1 rounded">Ctrl+V</kbd> (Win) ƒë·ªÉ d√°n
                    prompt.
                </div>
            </div>
        </section>

        <!-- PANEL 3: PERPLEXITY TEST (30%) -->
        <section class="flex-none lg:w-[30%] flex flex-col p-6 glass-panel panel-test">
            <h2 class="text-xs font-bold uppercase tracking-wider mb-4 flex items-center">
                <span class="mr-2">‚ö°</span> AI Live Test
            </h2>

            <div class="flex flex-col space-y-3 h-full">
                <div class="flex space-x-2">
                    <input type="password" id="apiKey" class="flex-1 form-input px-3 py-2 text-xs"
                        placeholder="API Key (Optional override)">
                    <select id="modelSelect" class="form-input px-2 py-2 text-xs w-24">
                        <optgroup label="Perplexity (Native)">
                            <option value="sonar">Sonar</option>
                            <option value="sonar-pro">Sonar Pro</option>
                            <option value="sonar-reasoning">Sonar Reasoning</option>
                            <option value="sonar-reasoning-pro">Sonar Reasoning Pro</option>
                            <option value="sonar-deep-research">Sonar Deep Research</option>
                        </optgroup>
                        <optgroup label="Open Source / Other">
                            <option value="r1-1776">R1-1776 (DeepSeek)</option>
                        </optgroup>
                        <optgroup label="Experimental / Web-Only?">
                            <option value="gpt-5.2">GPT-5.2</option>
                            <option value="gemini-3-flash">Gemini 3 Flash</option>
                            <option value="gemini-3-pro">Gemini 3 Pro</option>
                            <option value="claude-3-sonnet-4.5">Claude Sonnet 4.5</option>
                            <option value="claude-3-opus-4.6">Claude Opus 4.6</option>
                            <option value="grok-4.1">Grok 4.1</option>
                            <option value="kimi-k2.5">Kimi K2.5</option>
                        </optgroup>
                    </select>
                </div>

                <div class="relative flex-1 rounded-xl overflow-hidden flex flex-col bg-opacity-10 bg-black">
                    <div id="outputContent"
                        class="flex-1 p-4 overflow-y-auto text-sm prose dark:prose-invert max-w-none custom-scrollbar markdown-body">
                        <div class="text-center text-gray-400 mt-10">
                            <p class="text-2xl mb-2">üëã</p>
                            <p>Ready to test.</p>
                        </div>
                    </div>

                    <div id="testLoader"
                        class="absolute inset-0 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm flex items-center justify-center hidden">
                        <div class="flex flex-col items-center">
                            <div class="loading-spinner mb-2"></div>
                            <span class="text-xs font-mono text-primary animate-pulse">Thinking...</span>
                        </div>
                    </div>
                </div>

                <button id="testBtn"
                    class="w-full py-3 rounded-xl btn-vibrant active:scale-[0.98] transition-all flex items-center justify-center space-x-2">
                    <span>Test Prompt Now</span>
                    <span class="text-xs text-gray-300">via API</span>
                </button>

                <div class="flex justify-between text-[10px] text-gray-400 font-mono items-center">
                    <span id="tokenUsage">Tokens: 0</span>
                    <div class="flex space-x-2">
                        <button id="copyBtn" class="hover:text-primary">Copy</button>
                        <button id="exportJsonBtn" class="hover:text-primary">JSON</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer
        class="border-t border-gray-200 dark:border-gray-700 flex-none flex flex-col md:flex-row items-center justify-between px-4 py-3 text-[10px] text-gray-500 gap-2"
        style="background: var(--header-bg); backdrop-filter: blur(12px);">

        <!-- Left: History -->
        <div id="historyBar"
            class="flex items-center space-x-2 overflow-x-auto w-full md:w-1/3 no-scrollbar order-2 md:order-1">
            <span class="font-bold shrink-0">History:</span>
            <!-- History items -->
        </div>

        <!-- Center: Copyright -->
        <div class="text-center order-3 md:order-2 w-full md:w-auto">
            <p>¬© 2026 4R4S Prompt Pro. All rights reserved.</p>
            <p>Designed & developed with ‚ù§Ô∏è by Dang Vo.</p>
        </div>

        <!-- Right: Links -->
        <div class="flex items-center justify-end space-x-4 w-full md:w-1/3 order-1 md:order-3">
            <a href="#" class="hover:text-primary transition-colors">Documentation</a>
            <a href="#" class="hover:text-primary transition-colors">GitHub</a>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-markdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="script.js"></script>
</body>

</html>